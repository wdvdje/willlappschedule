<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TimeScape Planner</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f5f7fa;
      color: #333;
      text-align: center;
    }
    header {
      background: #4a90e2;
      color: white;
      padding: 1rem;
      font-size: 1.5rem;
    }
    .calendar-controls {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin: 20px 0 0 0;
    }
    .calendar-controls button {
      background: #4a90e2;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 1.1rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    .calendar-controls button:hover {
      background: #357abd;
    }
    .calendar-controls span {
      font-size: 1.25rem;
      min-width: 160px;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 5px;
      padding: 10px 10px 0 10px;
      max-width: 540px;
      margin: 0 auto 12px auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 1px 8px rgba(0,0,0,0.07);
    }
    .calendar-dayname {
      font-weight: bold;
      color: #4a90e2;
      padding-bottom: 4px;
      background: transparent;
      border: none;
      box-shadow: none;
      cursor: default;
    }
    .day {
      background: white;
      border-radius: 6px;
      padding: 10px 0 6px 0;
      min-height: 58px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.09);
      cursor: pointer;
      position: relative;
      transition: box-shadow 0.2s;
    }
    .day.today {
      outline: 2px solid #4a90e2;
    }
    .day.holiday {
      background: #ffe5e3 !important;
      color: #c0392b;
      font-weight: bold;
    }
    .day.selected {
      box-shadow: 0 2px 7px 0 #4a90e250;
      border: 2px solid #4a90e2;
    }
    .day .reminder-dot {
      width: 8px; height: 8px;
      background: #e67e22;
      border-radius: 50%;
      position: absolute;
      left: 50%;
      bottom: 8px;
      transform: translateX(-50%);
      display: inline-block;
    }
    .tasks, .dashboard {
      margin: 20px;
      text-align: left;
      max-width: 540px;
      margin-left: auto;
      margin-right: auto;
    }
    .tasks h2, .dashboard h2 {
      margin-bottom: 10px;
    }
    .progress {
      margin: 20px auto;
      width: 120px; height: 120px;
      border-radius: 50%;
      border: 10px solid #ddd;
      border-top-color: #4a90e2;
      transition: transform 0.3s ease;
    }
    input[type="text"], select {
      padding: 8px;
      width: 80%;
      margin-bottom: 10px;
      border-radius: 3px;
      border: 1px solid #ccc;
    }
    button {
      padding: 8px 12px;
      background: #4a90e2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .category-work { color: #e67e22; }
    .category-personal { color: #2ecc71; }
    .category-errands { color: #3498db; }
    .reminder-bar {
      background: #fbeee6;
      border-left: 4px solid #e67e22;
      color: #9a6b16;
      margin: 8px 0 0 0;
      padding: 5px 10px;
      border-radius: 5px;
      font-size: 0.96rem;
    }
    @media (max-width: 600px) {
      .calendar, .tasks, .dashboard { max-width: 100vw; }
    }
  </style>
</head>
<body>
  <header>ðŸ“… TimeScape Planner</header>

  <div class="calendar-controls">
    <button onclick="prevMonth()">&lt;</button>
    <span id="monthLabel"></span>
    <button onclick="nextMonth()">&gt;</button>
  </div>
  <section class="calendar" id="calendar"></section>

  <!-- Reminders for Selected Day -->
  <div id="reminderBar"></div>
  <div style="margin-bottom:18px;">
    <input type="text" id="reminderInput" placeholder="Add reminder to selected day..." />
    <button onclick="addReminder()">Add Reminder</button>
  </div>

  <!-- Tasks -->
  <section class="tasks">
    <h2>âœ… Tasks</h2>
    <input type="text" id="newTask" placeholder="Add a task..." />
    <select id="taskCategory">
      <option value="work">Work</option>
      <option value="personal">Personal</option>
      <option value="errands">Errands</option>
    </select>
    <button onclick="addTask()">Add</button>
    <ul id="taskList"></ul>
  </section>

  <!-- Dashboard -->
  <section class="dashboard">
    <h2>ðŸ“Š Dashboard</h2>
    <p id="summaryStats"></p>
    <div class="progress" id="progressRing" title="0% complete"></div>
  </section>

  <script>
    // Calendar state
    let selectedMonth, selectedYear, selectedDay = null;
    const calendar = document.getElementById('calendar');
    const monthLabel = document.getElementById('monthLabel');
    const reminderBar = document.getElementById('reminderBar');
    const reminderInput = document.getElementById('reminderInput');

    // Month names
    const monthNames = [
      "January", "February", "March", "April", "May", "June",
      "July", "August", "September", "October", "November", "December"
    ];
    const weekdayNames = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];

    // Pastel themes per month
    const themes = [
      { weekday: '#cce5ff', weekend: '#e0ccff' }, // Jan
      { weekday: '#ffd6e0', weekend: '#e6ccff' }, // Feb
      { weekday: '#d6f5d6', weekend: '#cce0ff' }, // Mar
      { weekday: '#fff0b3', weekend: '#ffd9b3' }, // Apr
      { weekday: '#e6ffe6', weekend: '#ccf2ff' }, // May
      { weekday: '#ffe6cc', weekend: '#ffcccc' }, // Jun
      { weekday: '#fff5cc', weekend: '#ffd6cc' }, // Jul
      { weekday: '#e6f7ff', weekend: '#d9e6f2' }, // Aug
      { weekday: '#ffe6b3', weekend: '#ffccb3' }, // Sep
      { weekday: '#ffd9b3', weekend: '#e6ccb3' }, // Oct
      { weekday: '#e6f0ff', weekend: '#d6e6f5' }, // Nov
      { weekday: '#ffcccc', weekend: '#ccffcc' }  // Dec
    ];

    // Example holidays: { 'MM-DD': 'Holiday Name' }
    const holidays = {
      '01-01': 'New Year\'s Day',
      '02-14': 'Valentine\'s Day',
      '03-17': 'St. Patrick\'s Day',
      '04-01': 'April Fool\'s Day',
      '07-04': 'Independence Day',
      '10-31': 'Halloween',
      '12-25': 'Christmas Day'
      // Add more as needed
    };

    function pad2(num) {
      return num < 10 ? '0' + num : '' + num;
    }

    function todayKey() {
      const now = new Date();
      return `${now.getFullYear()}-${pad2(now.getMonth()+1)}-${pad2(now.getDate())}`;
    }

    // Reminders stored as { [YYYY-MM-DD]: ["reminder text 1", ...] }
    function getReminders() {
      return JSON.parse(localStorage.getItem('reminders') || '{}');
    }
    function setReminders(data) {
      localStorage.setItem('reminders', JSON.stringify(data));
    }
    function addReminder() {
      if (!selectedDay) {
        alert('Select a day in the calendar first!');
        return;
      }
      const txt = reminderInput.value.trim();
      if (!txt) return;
      const key = `${selectedYear}-${pad2(selectedMonth+1)}-${pad2(selectedDay)}`;
      const reminders = getReminders();
      if (!reminders[key]) reminders[key] = [];
      reminders[key].push(txt);
      setReminders(reminders);
      reminderInput.value = '';
      showReminders(selectedDay);
      generateCalendar(); // update dots
    }
    function showReminders(day) {
      selectedDay = day;
      // Update selected UI
      [...calendar.children].forEach(cell => {
        if (cell.classList.contains('day')) {
          if (parseInt(cell.dataset.day) === day) cell.classList.add('selected');
          else cell.classList.remove('selected');
        }
      });
      // Show reminders for this day
      const key = `${selectedYear}-${pad2(selectedMonth+1)}-${pad2(day)}`;
      const reminders = getReminders();
      const items = reminders[key] || [];
      if (items.length > 0) {
        reminderBar.innerHTML = `
          <div class="reminder-bar">
            <b>Reminders for ${monthNames[selectedMonth]} ${day}, ${selectedYear}:</b>
            <ul style="margin:0 0 0 14px;padding:0 0 0 0;">
              ${items.map(r => `<li>${r}</li>`).join('')}
            </ul>
          </div>
        `;
      } else {
        reminderBar.innerHTML = '';
      }
    }

    function generateCalendar() {
      calendar.innerHTML = '';
      // Display month/year
      monthLabel.textContent = `${monthNames[selectedMonth]} ${selectedYear}`;

      // Add weekday names
      for (let d = 0; d < 7; d++) {
        const dayName = document.createElement('div');
        dayName.className = 'calendar-dayname';
        dayName.textContent = weekdayNames[d];
        calendar.appendChild(dayName);
      }

      // 1st day of month
      const firstDay = new Date(selectedYear, selectedMonth, 1);
      const daysInMonth = new Date(selectedYear, selectedMonth + 1, 0).getDate();
      const startDay = firstDay.getDay(); // 0=Sun

      // Get today's date for highlighting
      const today = new Date();
      const isCurrentMonth = today.getFullYear() === selectedYear && today.getMonth() === selectedMonth;

      // Get reminders for dots
      const reminders = getReminders();

      // Add blanks for days before the 1st
      for (let i = 0; i < startDay; i++) {
        const blank = document.createElement('div');
        calendar.appendChild(blank);
      }

      // Render days
      const theme = themes[selectedMonth];
      for (let day = 1; day <= daysInMonth; day++) {
        const date = new Date(selectedYear, selectedMonth, day);
        const dayOfWeek = date.getDay();
        const keyMMDD = pad2(selectedMonth+1) + '-' + pad2(day);
        const keyYYYYMMDD = `${selectedYear}-${pad2(selectedMonth+1)}-${pad2(day)}`;

        const cell = document.createElement('div');
        cell.className = 'day';
        cell.textContent = day;
        cell.dataset.day = day;

        // Color for today
        if (isCurrentMonth && day === today.getDate()) cell.classList.add('today');

        // Holiday highlight
        if (holidays[keyMMDD]) {
          cell.classList.add('holiday');
          cell.title = holidays[keyMMDD];
        } else if (dayOfWeek === 0 || dayOfWeek === 6) {
          cell.style.backgroundColor = theme.weekend;
        } else {
          cell.style.backgroundColor = theme.weekday;
        }

        // Dot if reminders
        if (reminders[keyYYYYMMDD] && reminders[keyYYYYMMDD].length > 0) {
          const dot = document.createElement('span');
          dot.className = 'reminder-dot';
          cell.appendChild(dot);
        }

        // Select handler
        cell.onclick = () => showReminders(day);

        // Selected day
        if (selectedDay === day) {
          cell.classList.add('selected');
        }

        calendar.appendChild(cell);
      }
    }

    function prevMonth() {
      if (selectedMonth === 0) {
        selectedMonth = 11;
        selectedYear--;
      } else {
        selectedMonth--;
      }
      selectedDay = null;
      reminderBar.innerHTML = '';
      generateCalendar();
    }
    function nextMonth() {
      if (selectedMonth === 11) {
        selectedMonth = 0;
        selectedYear++;
      } else {
        selectedMonth++;
      }
      selectedDay = null;
      reminderBar.innerHTML = '';
      generateCalendar();
    }

    // --- TASKS (unchanged) ---
    const taskList = document.getElementById('taskList');
    const progressRing = document.getElementById('progressRing');
    const summaryStats = document.getElementById('summaryStats');

    function loadTasks() {
      const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
      taskList.innerHTML = '';
      tasks.forEach((task, index) => {
        const li = document.createElement('li');
        const cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.checked = task.done;
        cb.onchange = () => {
          tasks[index].done = cb.checked;
          saveTasks(tasks);
        };
        const span = document.createElement('span');
        span.textContent = ' ' + task.text;
        span.className = `category-${task.category}`;
        li.appendChild(cb);
        li.appendChild(span);
        taskList.appendChild(li);
      });
      updateProgress(tasks);
      updateDashboard(tasks);
    }

    function saveTasks(tasks) {
      localStorage.setItem('tasks', JSON.stringify(tasks));
      updateProgress(tasks);
      updateDashboard(tasks);
    }

    function addTask() {
      const input = document.getElementById('newTask');
      const category = document.getElementById('taskCategory').value;
      const text = input.value.trim();
      if (!text) return;
      const tasks = JSON.parse(localStorage.getItem('tasks') || '[]');
      tasks.push({ text, category, done: false });
      saveTasks(tasks);
      input.value = '';
      loadTasks();
    }

    function updateProgress(tasks) {
      const total = tasks.length;
      const done = tasks.filter(t => t.done).length;
      const percent = total ? Math.round((done / total) * 100) : 0;
      progressRing.style.borderTopColor = percent === 100 ? "limegreen" : "#4a90e2";
      progressRing.title = percent + "% complete";
      progressRing.style.transform = `rotate(${percent * 3.6}deg)`;
    }

    function updateDashboard(tasks) {
      const total = tasks.length;
      const done = tasks.filter(t => t.done).length;
      const categories = tasks.reduce((acc, t) => {
        acc[t.category] = (acc[t.category] || 0) + 1;
        return acc;
      }, {});
      summaryStats.innerHTML = `
        Total tasks: ${total}<br>
        Completed: ${done}<br>
        Work: ${categories.work || 0}, Personal: ${categories.personal || 0}, Errands: ${categories.errands || 0}
      `;
    }

    // Init
    (function init() {
      const now = new Date();
      selectedMonth = now.getMonth();
      selectedYear = now.getFullYear();
      selectedDay = now.getDate();
      generateCalendar();
      showReminders(selectedDay);
      loadTasks();
    })();
  </script>
</body>
</html>
